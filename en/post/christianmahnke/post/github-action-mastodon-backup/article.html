<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8"><meta property="og:url" content="https://projektemacher.org/en/post/christianmahnke/post/github-action-mastodon-backup/article.html">
  <meta property="og:site_name" content="Projektemacher">
  <meta property="og:title" content="Mastodon backups with GitHub Actions">
  <meta property="og:description" content="Due to recent events">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2026-01-15T06:22:44+02:00">
    <meta property="article:modified_time" content="2026-01-15T06:22:44+02:00">
<title>
  Mastodon backups with GitHub Actions · Projektemacher
</title><link rel="canonical" href="https://projektemacher.org/en/post/christianmahnke/post/github-action-mastodon-backup/article.html"><meta name="author" content="Christian Mahnke">
  <meta name="dc.creator" content="Christian Mahnke">

<meta http-equiv="Content-Language" content="en">
<meta name="dc.type" content="Text">
<meta name="description" content="Due to recent events">
<meta property="og:type" content="article" /><meta property="og:url" content="https://projektemacher.org/en/post/christianmahnke/post/github-action-mastodon-backup/article.html" /><meta property="og:title" content="Mastodon backups with GitHub Actions" />

  
  
    
  



<meta name="keywords" content="blog, book, digitization, history, cultural history, Projektemacher.org, SocialMedia"><meta name="dc.subject" content="blog"><meta name="dc.subject" content="book"><meta name="dc.subject" content="digitization"><meta name="dc.subject" content="history"><meta name="dc.subject" content="cultural history"><meta name="dc.subject" content="Projektemacher.org"><meta name="dc.subject" content="SocialMedia">
<meta name="generator" content="Hugo 0.156.0">
<meta name="projektemacher.org:build-date" content="2026-03-01 05:25:23.469889108 &#43;0000 UTC m=&#43;13.886235846"><meta name="projektemacher.org:stats" content="{&#34;count&#34;:&#34;5067&#34;,&#34;latest&#34;:&#34;2027-10-19T12:47:44&#43;02:00&#34;}">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no">

<link rel="icon" type="image/png" href="https://projektemacher.org/images/favicon-32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://projektemacher.org/images/favicon-16.png" sizes="16x16"><link rel="icon" type="image/svg+xml" href="https://projektemacher.org/images/cm.svg">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<link href="https://projektemacher.org/css/3dcde2e700baa65d3814003bfc8fa7f9.min.da70574f9d939ceb6c2b98417c8559a15bdcab44b3c80c7fd03e43eb4da25843.css" rel="stylesheet" integrity="sha256-2nBXT52TnOtsK5hBfIVZoVvcq0SzyAx/0D5D602iWEM=">
<script src="https://projektemacher.org/js/5d85c20c8f862f9ecfa0aee0edbc8fe4.min.9e312a1385cd8a0a9b42110fe749082c05337c88e1df8799f014d3e0bddb2e9e.js" integrity="sha256-njEqE4XNigqbQhEP50kILAUzfIjh34eZ8BTT4L3bLp4="></script>


    
    

    

    <link rel="icon" type="image/png" href="https://projektemacher.org/images/favicon-32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://projektemacher.org/images/favicon-16.png" sizes="16x16">
    
        <link rel="icon" type="image/svg+xml" href="https://projektemacher.org/images/cm.svg">
    
    <link rel="alternate" type="text/bibtex" href="https://projektemacher.org/en/post/christianmahnke/post/github-action-mastodon-backup/citation.bib" title="Projektemacher" />
    <link rel="canonical" type="text/html" href="https://projektemacher.org/en/post/christianmahnke/post/github-action-mastodon-backup/" title="Projektemacher" />
    

    </head>

  
  
  <body class="colorscheme-light ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://projektemacher.org/en"><img alt="Logo" class="header-logo" src="https://projektemacher.org/images/laborant.svg" />
        Projektemacher</a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/blogs/">Sites &amp; Blogs</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/posts/">News</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/archive/">Archive</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/search/">Search</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://merch.projektemacher.org/en/">Merch</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://projektemacher.org/en/contact/">Contact</a>
            </li>
          
        
        
          
          
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="https://projektemacher.org/post/christianmahnke/post/github-action-mastodon-backup/article.html">Deutsch</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


      
  <div class="content page">
    <section class="container page ">
      <article>
        <header>
          <h1 class="header">Mastodon backups with GitHub Actions</h1>
        </header>
        <p>Due to recent events&hellip;</p>
<p>&hellip;even though I haven&rsquo;t posted anything on Mastodon for a long time, I wanted to publish my activities there again between Christmas and New Year.</p>
<p>Unfortunately, <a href="https://openbiblio.social/home" target="_blank">openbiblio.social</a> was <a href="https://bibcourse.eu/t/https-openbiblio-social-down/284/19" target="_blank">down</a>. Even though I don&rsquo;t plan to do so at the moment, here&rsquo;s an example of how you can use <a href="https://github.com/features/actions" target="_blank">GitHub Actions</a> to make a backup – just in case you ever want to move. In principle, you can also use it to create a static presentation for the site.</p>
<p><a href="https://github.com/kensanata/mastodon-archive" target="_blank"><code>mastodon-archive</code></a> is used for backup purposes. Since the Mastodon API of the home server is tapped, access to it must be configured. Please note that authentication must be renewed from time to time. Finally, direct messages are removed from the backup using <a href="https://jqlang.org/" target="_blank"><code>jq</code></a> (<code>jq “.mentions |= del(.[] | select(.visibility == ‘direct’))”</code>).</p>
<h2 id="configuration">
  Configuration
  <a class="heading-link" href="#configuration">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>Two configuration variables are required to use <code>mastodon-archive</code>:</p>
<ul>
<li><code>MASTODON_USER_SECRET</code></li>
<li><code>MASTODON_SERVER_SECRET</code></li>
</ul>
<p>The two required files can be generated locally with <code>mastodon-archive</code>. They are created when the programme is started for the first time.</p>
<h2 id="githubworkflowsmastodon-archiveyml">
  <code>.github/workflows/mastodon-archive.yml</code>
  <a class="heading-link" href="#githubworkflowsmastodon-archiveyml">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">Backup Mastodon</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">workflow_dispatch</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">schedule</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">cron</span>:  <span style="color:#e6db74">&#39;30 3 * * 1,3,6&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">MASTODON_USER</span>: <span style="color:#ae81ff">cmahnke@openbiblio.social</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">USER_SECRET_FILE</span>: <span style="color:#ae81ff">./openbiblio.social.user.cmahnke.secret</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">SERVER_SECRET_FILE</span>: <span style="color:#ae81ff">./openbiblio.social.server.secret</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">BACKUP_BRANCH</span>: <span style="color:#ae81ff">mastodon-backup</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">BACKUP_FILE</span>: <span style="color:#ae81ff">./openbiblio.social.user.cmahnke.json</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">BACKUP_DIRECTORY</span>: <span style="color:#ae81ff">./data/mastodon</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">concurrency</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">group</span>: <span style="color:#ae81ff">${{ github.workflow }}-${{ github.ref }}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cancel-in-progress</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">permissions</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">packages</span>: <span style="color:#ae81ff">write</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">contents</span>: <span style="color:#ae81ff">write</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">backup</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-24.04</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">permissions</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">contents</span>: <span style="color:#ae81ff">write</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v6</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">fetch-depth</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Create Backup Branch</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git checkout ${{ env.BACKUP_BRANCH }} || git switch --orphan ${{ env.BACKUP_BRANCH }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          mkdir -p ${{ env.BACKUP_DIRECTORY }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          echo &#34;*.secret&#34; &gt; ${{ env.BACKUP_DIRECTORY }}/.gitignore</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install dependencies</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">sudo apt-get install -y moreutils jq</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Set up Python</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-python@v6</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">python-version</span>: <span style="color:#e6db74">&#39;3.x&#39;</span>
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install mastodon-archive</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">pip install mastodon-archive</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Setup Secrets</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          echo &#34;${{ secrets.MASTODON_USER_SECRET }}&#34; &gt; ${{ env.USER_SECRET_FILE }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          echo &#34;${{ secrets.MASTODON_SERVER_SECRET }}&#34; &gt; ${{ env.SERVER_SECRET_FILE }}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Run backup</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">mastodon-archive archive --no-stopping --with-followers --with-following --with-mentions ${{ env.MASTODON_USER }}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Clean backup</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          jq &#39;(.mentions, .statuses) |= del(.[] | select(.visibility == &#34;direct&#34;))&#39; ${{ env.BACKUP_FILE }} | sponge ${{ env.BACKUP_FILE }}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Generate path name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">id</span>: <span style="color:#ae81ff">media-path</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          echo &#34;MEDIA_PATH=$(basename ${{ env.BACKUP_FILE }} .json)&#34; &gt;&gt; $GITHUB_OUTPUT</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Get media</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          mastodon-archive media ${{ env.MASTODON_USER }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          mastodon-archive media --collection favourites --collection bookmarks ${{ env.MASTODON_USER }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          ls -R ${{ steps.media-path.outputs.MEDIA_PATH }}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Clean secrets</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          rm ${{ env.USER_SECRET_FILE }}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          rm ${{ env.SERVER_SECRET_FILE }}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Commit changes</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{ env.BACKUP_DIRECTORY }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git config user.name &#34;GitHub Actions Bot&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git config user.email &#34;&lt;&gt;&#34;          
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git add *.json
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git add ${{ steps.media-path.outputs.MEDIA_PATH }}/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git commit -m &#34;Update Mastodon backup&#34; || echo &#34;No changes to commit&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          git push -u origin ${{ env.BACKUP_BRANCH }}</span>
</span></span></code></pre></div><h2 id="tidying-up">
  Tidying up
  <a class="heading-link" href="#tidying-up">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>If the repository where the backup is stored is publicly accessible, you may want to remove additional information. To do this, you can either adjust the options in <code>mastodon-archive</code> or, if more precision is required, use <code>jq</code> again.</p>
      </article>
    </section>
</div>



    </main>
    <footer class="footer"><div class="footer-container">
    <p class="projektemacher">
        Projektemacher is a <a href="https://projektemacher.org/en/">Projektemacher</a> blog <a title="Christian Mahnke" class="footer-link-cm" href="https://christianmahnke.de/"><img src="https://projektemacher.org/images/cm.svg" style="height: 16px; margin-left: .5rem;"></a>
    </p><p class="copyright">&copy; 2009 - 2026 </p><p class="privacy"><a href="https://projektemacher.org/privacy" title="Privacy policy">Privacy policy</a></p>Powered by <div class="footer-powered-by"><a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.</div></div>

  </footer>
  </body>

</html>
